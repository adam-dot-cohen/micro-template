FROM databricksruntime/standard:latest

LABEL maintainer="LASO Data"

RUN mkdir -p /app

ENV PATH $PATH:/databricks/conda/bin

# Copy the requirements.txt first, for separate dependency resolving and downloading
COPY requirements.txt /app/

# copy the main entrypoint files for the app
COPY __dbs-main__.py /app/

# COPY the main app files
COPY data-quality/*.py /app/
COPY data-quality/config/*.yml /app/config/
COPY data-quality/runtime/*.py /app/runtime/
RUN ls -lasR /app

COPY framework/*.py /app/framework/
COPY steplibrary/*.py /app/steplibrary/

RUN cd /app \
  && /databricks/conda/bin/pip install -r requirements.txt


# Copy the source code
#ONBUILD COPY . /app


# docker build --rm -t dataservices/data-quality --file dockerfile.data-quality .
# docker run -it  --rm dataservices/data-quality bash 